minKnots_1d = 1,
maxKnots_1d = 3,
startKnots_1d = 1,
degree = 2,
gaps = c(0))
salsa1dOutput.f <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = c("depth"),
predictionData = nysted.predictdata,
datain = nysted.analysisdata,
suppress.printout = TRUE)
runPartialPlots(model = salsa1dOutput.f$bestModel,
data = nysted.analysisdata,
varlist.in = 'depth',
factorlist.in = "season",
showKnots = TRUE,
type='link',
includeB0 = TRUE)
data(ns.data.re)
vpdata <- filter(ns.data.re, impact==0) %>%
mutate(response = birds)
head(vpdata)
initialModel <- glm(response ~ 1 + offset(log(area)), family = "quasipoisson",
data = wfdata)
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = 1,
maxKnots_1d = 3,
startKnots_1d = 1,
degree = 2,
gaps = c(0))
salsa1dOutput <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = c("depth"),
predictionData = nysted.predictdata,
datain = wfdata,
suppress.printout = TRUE)
summary(salsa1dOutput$bestModel)
salsa1dOutput$bestModel$splineParams[[2]]
# How many knots were chosen for depth?
salsa1dOutput$bestModel$splineParams[[2]]$knots
runPartialPlots(model = salsa1dOutput$bestModel, data = wfdata,
varlist = 'depth',
showKnots = TRUE,
type='link',
includeB0 = FALSE)
ggplot() + geom_point(data=wfdata, aes(x=depth, y=response), alpha=1/5) +
xlab("Sea Depth (m)") + ylab("Number of Birds")
initialModel <- glm(response ~ 1 + offset(log(area)), family = "quasipoisson",
data = wfdata)
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = 1,
maxKnots_1d = 3,
startKnots_1d = 1,
degree = 2,
gaps = c(0))
salsa1dOutput <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = c("depth"),
predictionData = nysted.predictdata,
datain = wfdata,
suppress.printout = TRUE)
summary(salsa1dOutput$bestModel)
# How many knots were chosen for depth?
salsa1dOutput$bestModel$splineParams[[2]]$knots
runPartialPlots(model = salsa1dOutput$bestModel, data = wfdata,
varlist = 'depth',
showKnots = TRUE,
type='link',
includeB0 = FALSE)
runPartialPlots(model = salsa1dOutput$bestModel, data = wfdata,
varlist = 'depth',
showKnots = TRUE, type='response',
includeB0 = FALSE)
runPartialPlots(model = salsa1dOutput$bestModel, data = wfdata,
varlist = 'depth',
showKnots = TRUE, type='response',
includeB0 = TRUE)
initialModel <- glm(response ~ 1 + as.factor(season) + offset(log(area)), family = "quasipoisson",
data = nysted.analysisdata)
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = 1,
maxKnots_1d = 3,
startKnots_1d = 1,
degree = 2,
gaps = c(0))
salsa1dOutput.f <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = c("depth"),
predictionData = nysted.predictdata,
datain = nysted.analysisdata,
suppress.printout = TRUE)
runPartialPlots(model = salsa1dOutput.f$bestModel,
data = nysted.analysisdata,
varlist.in = 'depth',
factorlist.in = "season",
showKnots = TRUE,
type='link',
includeB0 = TRUE)
data(ns.data.re)
vpdata <- filter(ns.data.re, impact==0) %>%
mutate(response = birds)
head(vpdata)
initialModel <- glm(response ~ 1 + as.factor(floodebb) + offset(log(area)), family = "quasipoisson",
data = vpdata)
varlist <- c("observationhour", "x.pos")
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = rep(1, length(varlist)),
maxKnots_1d = rep(1, length(varlist)),
startKnots_1d = rep(1, length(varlist)),
degree = rep(2, length(varlist)),
gaps = rep(0, length(varlist)))
salsa1dOutput.multi <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = varlist,
datain = vpdata,
suppress.printout = TRUE)
varlist <- c("observationhour")
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = rep(1, length(varlist)),
maxKnots_1d = rep(1, length(varlist)),
startKnots_1d = rep(1, length(varlist)),
degree = rep(2, length(varlist)),
gaps = rep(0, length(varlist)))
salsa1dOutput.multi <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = varlist,
datain = vpdata,
suppress.printout = TRUE)
varlist <- c( "x.pos")
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = rep(1, length(varlist)),
maxKnots_1d = rep(1, length(varlist)),
startKnots_1d = rep(1, length(varlist)),
degree = rep(2, length(varlist)),
gaps = rep(0, length(varlist)))
salsa1dOutput.multi <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = varlist,
datain = vpdata,
suppress.printout = TRUE)
debugonce(initialise.measures)
varlist <- c("observationhour", "x.pos")
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = rep(1, length(varlist)),
maxKnots_1d = rep(1, length(varlist)),
startKnots_1d = rep(1, length(varlist)),
degree = rep(2, length(varlist)),
gaps = rep(0, length(varlist)))
salsa1dOutput.multi <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = varlist,
datain = vpdata,
suppress.printout = TRUE)
debugonce(return.reg.spline.fit)
varlist <- c("observationhour", "x.pos")
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = rep(1, length(varlist)),
maxKnots_1d = rep(1, length(varlist)),
startKnots_1d = rep(1, length(varlist)),
degree = rep(2, length(varlist)),
gaps = rep(0, length(varlist)))
salsa1dOutput.multi <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = varlist,
datain = vpdata,
suppress.printout = TRUE)
sink()
sink()
sink()
sink()
sink()
sink()
sink()
explanatory
class(explanatory)
library(MRSea)
debugonce(return.reg.spline.fit)
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = 1,
maxKnots_1d = 3,
startKnots_1d = 1,
degree = 2,
gaps = c(0))
salsa1dOutput.f <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = c("depth"),
predictionData = nysted.predictdata,
datain = nysted.analysisdata,
suppress.printout = TRUE)
initialModel <- glm(response ~ 1 + as.factor(season) + offset(log(area)), family = "quasipoisson",
data = nysted.analysisdata)
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = 1,
maxKnots_1d = 3,
startKnots_1d = 1,
degree = 2,
gaps = c(0))
salsa1dOutput.f <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = c("depth"),
predictionData = nysted.predictdata,
datain = nysted.analysisdata,
suppress.printout = TRUE)
debugonce(return.reg.spline.fit)
initialModel <- glm(response ~ 1 + as.factor(floodebb) + offset(log(area)), family = "quasipoisson",
data = vpdata)
varlist <- c("observationhour", "x.pos")
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = rep(1, length(varlist)),
maxKnots_1d = rep(1, length(varlist)),
startKnots_1d = rep(1, length(varlist)),
degree = rep(2, length(varlist)),
gaps = rep(0, length(varlist)))
salsa1dOutput.multi <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = varlist,
datain = vpdata,
suppress.printout = TRUE)
knotSites
sink(*)
sink()
sink()
sink()
sink()
knotSites
sink()
knotSites
data.frame(explanatory, x1 = as.numeric(explanatory), x2=rep(1, length(explanatory)))
View(knotSites)
devtools::load_all(".")
varlist <- c("observationhour", "x.pos")
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = rep(1, length(varlist)),
maxKnots_1d = rep(1, length(varlist)),
startKnots_1d = rep(1, length(varlist)),
degree = rep(2, length(varlist)),
gaps = rep(0, length(varlist)))
salsa1dOutput.multi <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = varlist,
datain = vpdata,
suppress.printout = TRUE)
devtools::load_all(".")
varlist <- c("observationhour", "x.pos")
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = rep(1, length(varlist)),
maxKnots_1d = rep(1, length(varlist)),
startKnots_1d = rep(1, length(varlist)),
degree = rep(2, length(varlist)),
gaps = rep(0, length(varlist)))
salsa1dOutput.multi <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = varlist,
datain = vpdata,
suppress.printout = TRUE)
runPartialPlots(model = salsa1dOutput.multi$bestModel,
data = vpdata,
varlist.in = varlist,
factorlist.in = "floodebb",
showKnots = TRUE,
type='link',
includeB0 = TRUE)
pkgdown::build_site()
library(MRSea)
pkgdown::build_site()
.Last.error
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, comment='#>',
message=FALSE, eval=TRUE,
collapse=TRUE, dev='png')
require(MRSea)
require(splines)
require(ggplot2)
require(dplyr)
data("nysted.analysisdata")
mydata<-nysted.analysisdata # renamed just to be less typing!
mydata$blockid <- paste(mydata$transect.id, mydata$season, mydata$impact,sep = "")
myknots <- selectFctrKnots(mydata[, c("x.pos", "y.pos", "impact")],
nk=150,
s.eed=543)
head(myknots)
require(ggplot2)
ggplot() +
geom_point(data=mydata, aes(x.pos, y.pos)) +
geom_point(data=myknots, aes(x.pos, y.pos), colour='red') +
facet_wrap(~impact, nrow=2) +
theme_bw() + xlab('Easting (Km)') + ylab('Northing (Km)') +
coord_equal()
kg<-myknots[,1:2]
require(dplyr)
dists<-makeDists(datacoords = mydata[,c('x.pos', 'y.pos', 'impact')],
knotcoords = myknots,
knotmat = TRUE)
d2k = dists$dataDist
k2k = dists$knotDist
initialModel <- glm(response ~ as.factor(season) + as.factor(impact)
+ offset(log(area)), family = "quasipoisson",
data = mydata)
# make parameter set for running salsa2d
salsa2dlist<-list(fitnessMeasure = "QAIC",
knotgrid = myknots,
startKnots=10,
minKnots=4,
maxKnots=12)
salsa2dOutput<-runSALSA2D(model = initialModel,
salsa2dlist = salsa2dlist,
d2k=d2k,k2k=k2k,
suppress.printout = TRUE)
devtools::load_all(".")
salsa2dOutput<-runSALSA2D(model = initialModel,
salsa2dlist = salsa2dlist,
d2k=d2k,k2k=k2k,
suppress.printout = TRUE)
getRadiiSequence(method = "original",
numberofradii = 10,
distMatrix = d2k,
"basis"gaussian)
getRadiiSequence(method = "original",
numberofradii = 10,
distMatrix = d2k,
basis="gaussian")
debugonce(getRadiiSequence)
getRadiiSequence(method = "original",
numberofradii = 10,
distMatrix = d2k,
basis="gaussian")
minDist
which(is.infinite(distMatrix)
)
distMatrisx
distMatrix
myknots
require(ggplot2)
ggplot() +
geom_point(data=mydata, aes(x.pos, y.pos)) +
geom_point(data=myknots, aes(x.pos, y.pos), colour='red') +
facet_wrap(~impact, nrow=2) +
theme_bw() + xlab('Easting (Km)') + ylab('Northing (Km)') +
coord_equal()
kg<-myknots[,1:2]
debugonce(makeDists)
require(dplyr)
dists<-makeDists(datacoords = mydata[,c('x.pos', 'y.pos', 'impact')],
knotcoords = myknots,
knotmat = TRUE)
kcontr
dim(kcontr)
knotcoords.factor
is.factor(knotcoords.factor)
if(!is.factor(knotcoords.factor)) knotcoords.factor <- as.factor(knotcoords.factor)
if(!is.factor(datacoords.factor)) datacoords.factor <- as.factor(datacoords.factor)
is.factor(knotcoords.factor)
knotcoords.factor <- as.factor(knotcoords.factor)
is.factor(knotcoords.factor)
is.factor(knotcoords.factor)
is.factor(datacoords.factor)
kcontr <- model.matrix(~-1 + knotcoords.factor)
dim*(kcontr)
dim(kcontr)
head(dists$dataDist)
require(dplyr)
dists<-makeDists(datacoords = mydata[,c('x.pos', 'y.pos', 'impact')],
knotcoords = myknots,
knotmat = TRUE)
d2k = dists$dataDist
k2k = dists$knotDist
head(dists$dataDist)
devtools::load_all(".")
require(dplyr)
dists<-makeDists(datacoords = mydata[,c('x.pos', 'y.pos', 'impact')],
knotcoords = myknots,
knotmat = TRUE)
d2k = dists$dataDist
k2k = dists$knotDist
initialModel <- glm(response ~ as.factor(season) + as.factor(impact)
+ offset(log(area)), family = "quasipoisson",
data = mydata)
# make parameter set for running salsa2d
salsa2dlist<-list(fitnessMeasure = "QAIC",
knotgrid = myknots,
startKnots=10,
minKnots=4,
maxKnots=12)
salsa2dOutput<-runSALSA2D(model = initialModel,
salsa2dlist = salsa2dlist,
d2k=d2k,k2k=k2k,
suppress.printout = TRUE)
sink()
sink()
pkgdown::build_site()
library(MRSea)
pkgdown::build_site()
knitr::opts_chunk$set(fig=TRUE, warning=FALSE, message=FALSE,
eval=TRUE, cache=FALSE,
comment = '#>', collapse=TRUE, dev='png')
knitr::include_url("https://lindesaysh.github.io/MRSea/articles/website_examples.html")
data("nysted.analysisdata")
fit <- glm(response ~ season + depth, family="quasipoisson", data = nysted.analysisdata)
fullModel.gamMRSea <- make.gamMRSea(fit,
gamMRSea = TRUE)
pkgdown::build_site()
knitr::opts_chunk$set(fig=TRUE, warning=FALSE, message=FALSE,
eval=TRUE, cache=FALSE,
comment = '#>', collapse=TRUE, dev='png')
library(dplyr)
library(MRSea)
library(ggplot2)
# load the data
data("nysted.analysisdata")
wfdata <- filter(nysted.analysisdata, impact==0, season==1)
# load the prediction grid
data("nysted.predictdata")
ggplot() + geom_point(data=wfdata, aes(x=depth, y=response), alpha=1/5) +
xlab("Sea Depth (m)") + ylab("Number of Birds")
initialModel <- glm(response ~ 1 + offset(log(area)), family = "quasipoisson",
data = wfdata)
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = 1,
maxKnots_1d = 3,
startKnots_1d = 1,
degree = 2,
gaps = c(0))
salsa1dOutput <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = c("depth"),
predictionData = nysted.predictdata,
datain = wfdata,
suppress.printout = TRUE)
summary(salsa1dOutput$bestModel)
# How many knots were chosen for depth?
salsa1dOutput$bestModel$splineParams[[2]]$knots
runPartialPlots(model = salsa1dOutput$bestModel, data = wfdata,
varlist = 'depth',
showKnots = TRUE,
type='link',
includeB0 = FALSE)
runPartialPlots(model = salsa1dOutput$bestModel, data = wfdata,
varlist = 'depth',
showKnots = TRUE, type='response',
includeB0 = FALSE)
knitr::opts_chunk$set(fig=TRUE, warning=FALSE, message=FALSE,
eval=TRUE, cache=FALSE,
comment = '#>', collapse=TRUE, dev='png')
library(dplyr)
library(MRSea)
library(ggplot2)
# load the data
data("nysted.analysisdata")
wfdata <- filter(nysted.analysisdata, impact==0, season==1)
# load the prediction grid
data("nysted.predictdata")
ggplot() + geom_point(data=wfdata, aes(x=depth, y=response), alpha=1/5) +
xlab("Sea Depth (m)") + ylab("Number of Birds")
initialModel <- glm(response ~ 1 + offset(log(area)), family = "quasipoisson",
data = wfdata)
salsa1dlist <- list(fitnessMeasure = "QBIC",
minKnots_1d = 1,
maxKnots_1d = 3,
startKnots_1d = 1,
degree = 2,
gaps = c(0))
salsa1dOutput <- runSALSA1D(initialModel = initialModel,
salsa1dlist = salsa1dlist,
varlist = c("depth"),
predictionData = nysted.predictdata,
datain = wfdata,
suppress.printout = TRUE)
summary(salsa1dOutput$bestModel)
runPartialPlots(model = salsa1dOutput$bestModel, data = wfdata,
varlist = 'depth',
showKnots = TRUE,
type='link',
includeB0 = FALSE)
runPartialPlots(model = salsa1dOutput$bestModel, data = wfdata,
varlist = 'depth',
showKnots = TRUE, type='response',
includeB0 = FALSE)
files <- list.files("web", "\\.Rmd$")
for (file in file.path("web", files)) {
lines <- readLines(file, n = 10)
title_idx <- grep("^title: ", lines)
if (length(title_idx) > 0) {
title <- sub("^title: ", "", lines[title_idx[1]])
title <- sub('^"', "", title)
title <- sub('"$', "", title)
cat("* [",
title,
"](https://lindesaysh.github.io/MRSea/articles/",
sub("\\.Rmd", ".html", file),
")\n",
sep = ""
)
}
}
files <- list.files(".", "\\.Rmd$")
for (file in files) {
lines <- readLines(file, n = 10)
title_idx <- grep("^title: ", lines)
if (length(title_idx) > 0) {
title <- sub("^title: ", "", lines[title_idx[1]])
title <- sub('^"', "", title)
title <- sub('"$', "", title)
cat("* [",
title,
"](https://lindesaysh.github.io/MRSea/articles/",
sub("\\.Rmd", ".html", file),
")\n",
sep = ""
)
}
}
pkgdown::build_site_github_pages()
?pkgdown::build_site_github_pages
