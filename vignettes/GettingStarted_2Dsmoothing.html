<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="LAS Scott-Hayward" />

<meta name="date" content="2023-08-30" />

<title>Getting Started with MRSea: Two dimensional smoothing</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Getting Started with MRSea: Two dimensional
smoothing</h1>
<h4 class="author">LAS Scott-Hayward</h4>
<h4 class="date">2023-08-30</h4>



<!-- **Please reference this document as:** -->
<!-- Scott-Hayward, L.A.S., Mackenzie, M.L. and Walker, C.G. (2021). Vignette for the MRSea Package v1.3: Statistical Modelling of bird and cetacean distributions in offshore renewables development areas. Centre for Research into Ecological and Environmental Modelling, University of St Andrews. -->
<!-- ******* -->
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>MRSea</code> package was developed for analysing data that
was collected for assessing potential impacts of renewable developments
on marine wildlife, although the methods are applicable to many other
studies as well. For example, these methods have been used for more
general spatial distribution modelling and to analyse GPS tagging data
for home ranges.</p>
<p>The <code>MRSea</code> package primarily fits Generalised Additive
Models (GAMs) using a spatially adaptive model selection framework for
both one and two dimensional covariates using the functions
<code>runSALSA1D</code> and <code>runSALSA2D</code>. These functions
implement the methods of implement the methods of <span class="citation">Walker et al. (2010)</span>, <span class="citation">Scott-Hayward et al. (2013)</span> and <span class="citation">Scott-Hayward et al. (2022)</span>. In addition,
options are available for a variety of different splines and the
estimation of robust standard errors if residual correlation is
present.</p>
<p>A class of model <code>gamMRSea</code> is created when running either
SALSA 1D or 2D. This retains within the model object information
regarding fitting, such as the <code>splineParam</code> object and the
panel structure (if present). The use of the <code>summary</code>
function on these models returns both raw and robust standard errors,
with the <em>p</em>-values from the models hypothesis test using the
robust standard errors. The robust standard errors are obtained using
the panel structure given (independence is one panel per data point and
is the default if no structure is given).</p>
<p>In addition to the functions required to run the models (which we
shall go through below) there are also a variety of associated functions
for:</p>
<p><strong>Covariate Checking/Selection:</strong></p>
<ul>
<li><code>summary.gamMRSea</code> (summary function for models)</li>
<li><code>runPartialPlots</code> (to plot 1D partial smooth
relationships),</li>
<li><code>anova.gamMRSea</code> (for model selection; (ANOVA) for robust
standard errors) and</li>
</ul>
<p><strong>Diagnostics:</strong></p>
<ul>
<li><code>runACF</code> (to assess residual correlation),</li>
<li><code>runsTest</code> (to assess residual correlation)</li>
<li><code>plotMeanVar</code> (to assess the mean-variance
relationship)</li>
<li><code>runDiagnostics</code> (plots of observed vs fitted and fitted
vs scaled Pearsons residuals),</li>
<li><code>timeInfluenceCheck</code>/<code>runInfluence</code> (assessing
the influence of data on precision and predictions),</li>
<li><code>plotCumRes</code> (plots of cumulative residuals)</li>
</ul>
<p><strong>Inference:</strong></p>
<ul>
<li><code>do.bootstrap.cress.robust</code> (percentile based confidence
intervals).</li>
<li><code>getDifferences</code> (identifying differences between two
prediction surfaces)</li>
</ul>
</div>
<div id="fitting-a-simple-2d-model" class="section level1">
<h1>Fitting a Simple 2D Model</h1>
<p>The data we shall use for this example is from a Danish offshore
windfarm and is part of the MRSea package. The data are counts of birds
collected along transects over a number of surveys and years. In this
first example, we will use all of the data together and assess if there
is a relationship between number of birds and sea depth.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(MRSea)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;nysted.analysisdata&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>wfdata <span class="ot">&lt;-</span> <span class="fu">filter</span>(nysted.analysisdata, impact<span class="sc">==</span><span class="dv">0</span>, season<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># load the prediction grid</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;nysted.predictdata&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>preddata <span class="ot">&lt;-</span> <span class="fu">filter</span>(nysted.predictdata, impact<span class="sc">==</span><span class="dv">0</span>, season<span class="sc">==</span><span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(wfdata) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x=</span>x.pos, <span class="at">y=</span>y.pos, <span class="at">fill=</span>response, <span class="at">height=</span><span class="fu">sqrt</span>(area), <span class="at">width=</span><span class="fu">sqrt</span>(area))) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>,<span class="at">name=</span><span class="st">&quot;No. Birds&quot;</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Easting (km)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing (km)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="fitting-a-2d-smooth" class="section level2">
<h2>Fitting a 2D smooth</h2>
<p>Set up the initial model with the offset term (if required) and
specify the parameters required. Here we add an offset to be the size of
the segment associated with the bird counts. In reality, our bird counts
are over a particular area so we have counts per unit area.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>initialModel <span class="ot">&lt;-</span> <span class="fu">glm</span>(response <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area)), <span class="at">family =</span> <span class="st">&quot;quasipoisson&quot;</span>, </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                    <span class="at">data =</span> wfdata)</span></code></pre></div>
<p>First up we must create a grid of knots that will be used as
candidate knot locations. The locations are a subset of the data
locations and are space-filled to have good coverage across the
two-dimensional space.</p>
<p>Depending on the size of your data set this could take while and be
slightly different every time you run it so I suggest using a seed and
perhaps saving the knotgrid as a file.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>knotgrid<span class="ot">&lt;-</span> <span class="fu">getKnotgrid</span>(<span class="at">coordData =</span> <span class="fu">cbind</span>(wfdata<span class="sc">$</span>x.pos, wfdata<span class="sc">$</span>y.pos),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                       <span class="at">numKnots =</span> <span class="dv">300</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                       <span class="at">plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Plot showing the candidate knot locations in red and the raw data locations in black." />
<p class="caption">
Plot showing the candidate knot locations in red and the raw data
locations in black.
</p>
</div>
<p>The <code>makeDists</code> function creates two matrices. One for the
distances between each data point and knot point (<code>dataDist</code>)
and one for the distances between each knot point and all other knot
points (<code>knotDist</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>distMats <span class="ot">&lt;-</span> <span class="fu">makeDists</span>(<span class="fu">cbind</span>(wfdata<span class="sc">$</span>x.pos, wfdata<span class="sc">$</span>y.pos), knotgrid)</span></code></pre></div>
<p>Next we specify the parameters needed to run the SALSA2D algorithm
which will select the number and location of knots for the smooth of x
and y coordinates. Distance matrices (data to knots and knot to knots),
a fit statistic and min, max and start knots.</p>
<p>The fitness measure can be one of several options (AIC, BIC, QAIC,
QBIC, CV). Here we use QBIC as we have a quasi model and information
criterion fitting is faster than cross-validation.</p>
<ul>
<li><code>knotgrid</code> is the grid of candidate knot locations we
created.</li>
<li><code>startKnots</code> specifies the number of knots the SALSA2D
algorithm uses to initialise the process. The starting number depends a
bit on the size/heterogeneity of the surface. I’d suggest starting with
10 knots to get a feel for the outputs.</li>
<li><code>minKnots</code> specifies the minimum number of knots to be
selected. This must be the same or smaller than
<code>startKnots</code></li>
<li><code>maxKnots</code> specifies the maximum number of knots to be
selected. This must be the same or larger than
<code>startKnots</code>.</li>
<li><code>gap</code> specifies the minimum gap between knots. Usually
this is fine to be set at zero but occasionally there can be estimation
problems and so a gap can be set (in the units of the covariate).</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># make parameter set for running salsa2d</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>salsa2dlist<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="at">fitnessMeasure =</span> <span class="st">&#39;QBIC&#39;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                  <span class="at">knotgrid =</span> knotgrid,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                  <span class="at">startKnots=</span><span class="dv">10</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                  <span class="at">minKnots=</span><span class="dv">4</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                  <span class="at">maxKnots=</span><span class="dv">15</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                  <span class="at">gap=</span><span class="dv">0</span>)</span></code></pre></div>
<ol start="11" style="list-style-type: decimal">
<li>Run SALSA2D to find the appropriate number and location of knots for
the 2D smooth term of <code>x.pos</code> and <code>y.pos</code>. The
model inputted to the SALSA2D algorithm is the initial model. If you
have a model with univariate smooth terms, you can put in the output
best model from the SALSA1D algorithm in this step.The default basis
function is the <code>gaussian</code> but you can also use the
<code>exponential</code> by specifying the <code>basis</code>
parameter.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>salsa2dOutput<span class="ot">&lt;-</span><span class="fu">runSALSA2D</span>(<span class="at">model =</span> initialModel,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                          <span class="at">salsa2dlist =</span> salsa2dlist,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                          <span class="at">d2k=</span>distMats<span class="sc">$</span>dataDist,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                          <span class="at">k2k=</span>distMats<span class="sc">$</span>knotDist,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                          <span class="at">suppress.printout =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Note that <code>suppress.printout</code> will not print the progress
of <code>runSALSA2D</code> into your workspace but will save the output
to a log file (<em>salsa2d.log</em>) in your working directory. You may
find it helpful to not suppress the print out to begin with so you can
see what is happening.</p>
<p>Use the built in summary function (<code>summary.gamMRSea</code>) to
look at the summary of the model. Note that robust standard errors are
given alongside the raw standard errors and information regarding panels
is at the bottom of the output. If each data point is a panel, then
independence is assumed and the two standard error columns will be
identical.</p>
</div>
<div id="model-summary" class="section level2">
<h2>Model Summary</h2>
<p>The object <code>salsa2dOutput</code> has two components:</p>
<ul>
<li><code>bestModel</code>: the final model</li>
<li><code>fitStat</code>: The fitness measure of the best model using
the fitness measure specified.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">summary</span>(salsa2dOutput<span class="sc">$</span>bestModel)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; gamMRSea(formula = response ~ LRF.g(radiusIndices, dists, radii, </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt;     aR) + offset(log(area)), family = &quot;quasipoisson&quot;, data = wfdata, </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt;     splineParams = splineParams)</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; Deviance Residuals: </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; -3.7456  -1.1390  -0.2942  -0.0308  15.5232  </span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt;                                          Estimate Std. Error Robust S.E.</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; (Intercept)                               -12.068      1.662       1.662</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b1   11.675      1.290       1.290</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b2  -35.043      6.107       6.107</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b3   20.495      2.604       2.604</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b4   12.587      1.602       1.602</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b5   52.913      7.905       7.905</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b6  -28.821      4.581       4.581</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt;                                          t value Pr(&gt;|t|)    </span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; (Intercept)                               -7.261 7.05e-13 ***</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b1   9.048  &lt; 2e-16 ***</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b2  -5.738 1.23e-08 ***</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b3   7.871 8.08e-15 ***</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b4   7.856 9.08e-15 ***</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b5   6.694 3.40e-11 ***</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; LRF.g(radiusIndices, dists, radii, aR)b6  -6.291 4.48e-10 ***</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for quasipoisson family taken to be 8.001567)</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 4987.6  on 1153  degrees of freedom</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 3037.2  on 1147  degrees of freedom</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; AIC:  NA</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; Max Panel Size = 1 (independence assumed); Number of panels = 1154</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 7</span></span></code></pre></div>
<p>You can find the number of knots chosen for a variable by querying
the spline parameters list in the model object.The two dimensional
smooth is always in the first element of the spline parameters list. In
this case, 6 knots have been selected.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># How many knots were chosen for depth?</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>salsa2dOutput<span class="sc">$</span>bestModel<span class="sc">$</span>splineParams[[<span class="dv">1</span>]]<span class="sc">$</span>knotPos</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt; [1]  54 136 275 111 299 102</span></span></code></pre></div>
</div>
<div id="fitted-surface" class="section level2">
<h2>Fitted surface</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(wfdata) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x=</span>x.pos, <span class="at">y=</span>y.pos, <span class="at">fill=</span><span class="fu">fitted</span>(salsa2dOutput<span class="sc">$</span>bestModel), <span class="at">height=</span><span class="fu">sqrt</span>(area), <span class="at">width=</span><span class="fu">sqrt</span>(area))) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>,<span class="at">name=</span><span class="st">&quot;No. Birds&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Easting (km)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing (km)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="making-predictions" class="section level2">
<h2>Making predictions</h2>
<p>To make predictions, we need to calculate the distances between each
prediction point and each knot point. We can use the
<code>makeDists</code> function again but this time we don’t need the
knot to knot matrix and therefore specify
<code>knotmat = FALSE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>preddist<span class="ot">&lt;-</span><span class="fu">makeDists</span>(<span class="fu">cbind</span>(preddata<span class="sc">$</span>x.pos, preddata<span class="sc">$</span>y.pos),</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                 knotgrid, <span class="at">knotmat=</span><span class="cn">FALSE</span>)<span class="sc">$</span>dataDist</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># make predictions on response scale</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>preds<span class="ot">&lt;-</span><span class="fu">predict</span>(<span class="at">newdata =</span> preddata,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>               <span class="at">g2k =</span> preddist,</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>               <span class="at">object =</span> salsa2dOutput<span class="sc">$</span>bestModel)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(preddata) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">x=</span>x.pos, <span class="at">y=</span>y.pos, <span class="at">fill=</span>preds, <span class="at">height=</span><span class="fu">sqrt</span>(area), <span class="at">width=</span><span class="fu">sqrt</span>(area))) <span class="sc">+</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>,<span class="at">name=</span><span class="st">&quot;No. Birds&quot;</span>) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Easting (km)&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Northing (km)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="interaction-terms" class="section level2">
<h2>Interaction terms:</h2>
<p>The simplest way to specify an interaction term is to add this to the
<code>salsa2dlist</code> object.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>salsa2dlist<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="at">fitnessMeasure =</span> <span class="st">&#39;QBIC&#39;</span>, </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                  <span class="at">knotgrid =</span> knotgrid,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                  <span class="at">startKnots=</span><span class="dv">10</span>, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                  <span class="at">minKnots=</span><span class="dv">4</span>, </span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>                  <span class="at">maxKnots=</span><span class="dv">15</span>, </span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                  <span class="at">gap=</span><span class="dv">0</span>, </span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>                  <span class="at">interactionTerm=</span><span class="st">&quot;as.factor(impact)&quot;</span>)</span></code></pre></div>
<p>There is an example of this in use in the <a href="https://lindesaysh.github.io/MRSea/article/RenewablesCaseStudy_MRSea_v1.3">case
study vignette</a>. The limitation to this method is that the knot
locations in the different levels (e.g. before and after impact) are in
the same locations and only the coefficients are permitted to change.
This may not always be a sensible option especially if the spatial range
of the different factor levels varies. In this case, there is an
alternative which allows the locations to differ. An example of this is
in the <a href="https://lindesaysh.github.io/MRSea/article/Interactions_salsa2d_MRSea_v1.3">interactions
vignette</a>.</p>
</div>
</div>
<div id="further-information" class="section level1">
<h1>Further information:</h1>
<p>For information on:</p>
<ol style="list-style-type: decimal">
<li><a href="https://lindesaysh.github.io/MRSea/article/FittingDifferentSplines_MRSea">Other
types of 2D spline</a></li>
<li><a href="https://lindesaysh.github.io/MRSea/article/ModelDiagnostics_MRSea">Model
Diagnostics</a></li>
<li><a href="https://lindesaysh.github.io/MRSea/article/DistanceSampling">Distance
Sampling</a></li>
<li>Distance sampling, simple interactions, <code>gamMRSea</code> model
diagnostics, inference via bootstrapping and using robust standard
errors to deal with residual correlation see the <a href="https://lindesaysh.github.io/MRSea/article/RenewablesCaseStudy_MRSea">Full
Case Study</a>.</li>
<li>More complex <a href="https://lindesaysh.github.io/MRSea/article/Interactions_salsa2d_MRSea">interactions</a>.</li>
<li>Using non Euclidean distances to measure the similarity between
points. For example, using geodesic distances to represent “as the fish
swims” rather than “as the crow flies”. This takes into account
distances around exclusion areas such as coastlines or lakes. See <a href="(https://lindesaysh.github.io/MRSea/article/Geodesic_2dsmoothing_MRSea)">here</a></li>
</ol>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ScottH2013" class="csl-entry">
Scott-Hayward, L. A. S., M. L. Mackenzie, C. R. Donovan, C. G. Walker,
and E. Ashe. 2013. <span>“Complex Region Spatial Smoother
(CReSS).”</span> <em>Journal of Computational and Graphical
Statistics</em>. <a href="https://doi.org/10.1080/10618600.2012.762920">https://doi.org/10.1080/10618600.2012.762920</a>.
</div>
<div id="ref-ScottH2022" class="csl-entry">
Scott-Hayward, L. A. S., M. L. Mackenzie, C. G. Walker, G. Shatumbu, W.
Kilian, and P. du Preez. 2022. <span>“Automated Surface Feature
Selection Using SALSA2D: An Illustration Using Elephant Mortality Data
in Etosha National Park.”</span> <em>arXiv e-Prints</em>,
arXiv:2202.07977. <a href="https://doi.org/10.48550/arXiv.2202.07977">https://doi.org/10.48550/arXiv.2202.07977</a>.
</div>
<div id="ref-Walker2010" class="csl-entry">
Walker, C. G., M. L. Mackenzie, C. R. Donovan, and M. J. O’Sullivan.
2010. <span>“SALSA - a Spatially Adaptive Local Smoothing
Algorithm.”</span> <em>Journal of Statistical Computation and
Simulation</em> 81 (2): 179–91.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
