<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MRSea">
<title>MRSea: 2D Interaction Example â€¢ MRSea</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="MRSea: 2D Interaction Example">
<meta property="og:description" content="MRSea">
<meta name="google-site-verification" content="dUtyCOSNh9HYALyeXliAlT0ZBt-A4tor8kaiLgS3DRc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">MRSea</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/web/IntroductiontoMRSea.html">Introduction to the package</a>
    <h6 class="dropdown-header" data-toc-skip>Basic examples</h6>
    <a class="dropdown-item" href="../../articles/GettingStarted_1Dsmoothing.html">One-dimensional smooths</a>
    <a class="dropdown-item" href="../../articles/GettingStarted_2Dsmoothing.html">Two-dimensional smooths</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/web/FittingDifferentSplines_MRSea.html">Using Different Splines</a>
    <a class="dropdown-item" href="../../articles/web/Interactions_salsa2d_MRSea.html">Interactions for 2D smooths</a>
    <a class="dropdown-item" href="../../articles/web/ModelDiagnostics_MRSea.html">Model Diagnostics</a>
    <a class="dropdown-item" href="../../articles/web/TheTweedieDistribution_MRSea.html">Using the Tweedie Distribution</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/web/Publications.html">Publications</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/web/DistanceSampling.html">Brief Intro to Distance Sampling</a>
    <a class="dropdown-item" href="../../articles/web/RenewablesCaseStudy_MRSea.html">Renewables Case Study</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>More advanced Usage</h6>
    <a class="dropdown-item" href="../../articles/web/Geodesic_2dsmoothing_MRSea.html">Geodesic smoothing</a>
    <a class="dropdown-item" href="../../articles/web/UserRadiiChoice_MRSea.html">Basis radii selection</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lindesaysh/MRSea/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>MRSea: 2D Interaction Example</h1>
                        <h4 data-toc-skip class="author">LAS
Scott-Hayward, CG Walker and ML Mackenzie</h4>
            
            <h4 data-toc-skip class="date">2024-05-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lindesaysh/MRSea/blob/HEAD/vignettes/web/Interactions_salsa2d_MRSea.Rmd" class="external-link"><code>vignettes/web/Interactions_salsa2d_MRSea.Rmd</code></a></small>
      <div class="d-none name"><code>Interactions_salsa2d_MRSea.Rmd</code></div>
    </div>

    
    
<p>This vignette shows an analysis which allows different knot locations
for different levels of a spatial interaction term. This may be
particularly useful where the spatial coverage of the two levels is not
the same.</p>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Load the distance sampling corrected Nysted data from the
package.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nysted.analysisdata"</span><span class="op">)</span></span>
<span><span class="va">mydata</span><span class="op">&lt;-</span><span class="va">nysted.analysisdata</span> <span class="co"># renamed just to be less typing!</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Fit an initial Model to the data. Here we include only the
<code>impact</code> variable as a factor along with the offset of cell
area.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span><span class="op">$</span><span class="va">blockid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">transect.id</span>, <span class="va">mydata</span><span class="op">$</span><span class="va">season</span>, <span class="va">mydata</span><span class="op">$</span><span class="va">impact</span>,sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="make-distance-matrices">Make distance matrices<a class="anchor" aria-label="anchor" href="#make-distance-matrices"></a>
</h3>
<ol start="3" style="list-style-type: decimal">
<li>Create a grid of knots that will be used as possible knot locations.
Create one grid for before and one for after. As we have complete
spatial overlap between the two <code>impact</code> levels, I have
chosen the same number of candidate knot locations for each.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myknots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/selectFctrKnots.html">selectFctrKnots</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x.pos"</span>, <span class="st">"y.pos"</span>, <span class="st">"impact"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                           nk<span class="op">=</span><span class="fl">150</span>,</span>
<span>                           s.eed<span class="op">=</span><span class="fl">543</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">myknots</span><span class="op">)</span></span>
<span><span class="co">#&gt;    x.pos   y.pos impact</span></span>
<span><span class="co">#&gt; 1 659.75 6042.25      0</span></span>
<span><span class="co">#&gt; 2 706.25 6049.75      0</span></span>
<span><span class="co">#&gt; 3 688.25 6037.75      0</span></span>
<span><span class="co">#&gt; 4 693.75 6050.25      0</span></span>
<span><span class="co">#&gt; 5 658.25 6044.25      0</span></span>
<span><span class="co">#&gt; 6 678.25 6052.25      0</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">mydata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x.pos</span>, <span class="va">y.pos</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">myknots</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x.pos</span>, <span class="va">y.pos</span><span class="op">)</span>, colour<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">impact</span>, nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Easting (Km)'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Northing (Km)'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Interactions_salsa2d_MRSea_files/figure-html/selknots-1.png" alt="Figure showing the candidate knot locations for each of the interaction levels" width="700"><p class="caption">
Figure showing the candidate knot locations for each of the interaction
levels
</p>
</div>
<p>The <code>myknots</code> object has three columns (x, y and impact)
but it is also useful to have an object with just the coordinates.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kg</span><span class="op">&lt;-</span><span class="va">myknots</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Create distances between knots and data. At some future point, this
ability will be a function in the package.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">dists</span><span class="op">&lt;-</span><span class="fu"><a href="../../reference/makeDists.html">makeDists</a></span><span class="op">(</span>datacoords <span class="op">=</span> <span class="va">mydata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x.pos'</span>, <span class="st">'y.pos'</span>, <span class="st">'impact'</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                 knotcoords <span class="op">=</span> <span class="va">myknots</span>, </span>
<span>                 knotmat <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">d2k</span> <span class="op">=</span> <span class="va">dists</span><span class="op">$</span><span class="va">dataDist</span></span>
<span><span class="va">k2k</span> <span class="op">=</span> <span class="va">dists</span><span class="op">$</span><span class="va">knotDist</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h3>
<ol start="5" style="list-style-type: decimal">
<li>Run SALSA2D to find the appropriate number and location of knots for
the 2D smooth term of <code>x.pos</code> and <code>y.pos</code>. For
speed of fitting, I am specifying a small number of knots and a quick
fitness measure, QAIC. Remember that as we are using the distance matrix
to act as the interaction, we do not specify the interaction in the
<code>salsa2dlist</code> object but we do include <code>impact</code> as
a main effect in the initial model. Additionally, the knotgrid specified
in <code>salsa2dlist</code> must have three columns (x, y, interaction
level).</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initialModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">response</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">season</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">impact</span><span class="op">)</span> </span>
<span>                    <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span><span class="op">)</span>, family <span class="op">=</span> <span class="st">"quasipoisson"</span>, </span>
<span>                    data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note</strong> that by setting startKnots = 10, 10 knots will
be space-filled across the combined grids which may lead to unequal
starting positions biased towards one factor level. To avoid this, you
can manually specify starting locations. This is described at the end of
the document.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make parameter set for running salsa2d</span></span>
<span><span class="va">salsa2dlist</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fitnessMeasure <span class="op">=</span> <span class="st">"QAIC"</span>, </span>
<span>                  knotgrid <span class="op">=</span> <span class="va">myknots</span>, </span>
<span>                  startKnots<span class="op">=</span><span class="fl">10</span>, </span>
<span>                  minKnots<span class="op">=</span><span class="fl">4</span>, </span>
<span>                  maxKnots<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">salsa2dOutput</span><span class="op">&lt;-</span><span class="fu"><a href="../../reference/runSALSA2D.html">runSALSA2D</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">initialModel</span>, </span>
<span>                          salsa2dlist <span class="op">=</span> <span class="va">salsa2dlist</span>,</span>
<span>                          d2k<span class="op">=</span><span class="va">d2k</span>,k2k<span class="op">=</span><span class="va">k2k</span>,</span>
<span>                          suppress.printout <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Assess the output for the location of the selected knots.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mymodel</span><span class="op">&lt;-</span><span class="va">salsa2dOutput</span><span class="op">$</span><span class="va">bestModel</span></span>
<span><span class="va">chosenknots</span> <span class="op">&lt;-</span> <span class="va">myknots</span><span class="op">[</span><span class="va">mymodel</span><span class="op">$</span><span class="va">splineParams</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">knotPos</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">chosenknots</span>, <span class="va">impact</span><span class="op">)</span></span>
<span><span class="co">#&gt;   impact n</span></span>
<span><span class="co">#&gt; 1      0 7</span></span>
<span><span class="co">#&gt; 2      1 3</span></span>
<span><span class="co">#startingknots &lt;- myknots[startknotlocs,]</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">imp.labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pre-Construction"</span>, <span class="st">"Post-Construction"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">imp.labs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># quick look to see what was chosen</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">myknots</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.pos</span>, y<span class="op">=</span><span class="va">y.pos</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.pos</span>, y<span class="op">=</span><span class="va">y.pos</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, data<span class="op">=</span><span class="va">chosenknots</span>, alpha<span class="op">=</span><span class="fl">4</span><span class="op">/</span><span class="fl">5</span>, </span>
<span>             show.legend <span class="op">=</span> <span class="cn">FALSE</span>, shape<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Easting (Km)'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Northing (Km)'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">impact</span>, ncol<span class="op">=</span><span class="fl">1</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>impact<span class="op">=</span><span class="va">imp.labs</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Interactions_salsa2d_MRSea_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<ol start="7" style="list-style-type: decimal">
<li>You can find the knot locations chosen by querying model
object.</li>
</ol>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mymodel</span><span class="op">$</span><span class="va">splineParams</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">knotPos</span></span>
<span><span class="co">#&gt;  [1] 157 162 131 117 159  47  23  24 109  13</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cv.gamMRSea.html">cv.gamMRSea</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="va">mymodel</span>, K<span class="op">=</span><span class="fl">10</span>, s.eed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 5.942072</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="making-predictions">Making predictions<a class="anchor" aria-label="anchor" href="#making-predictions"></a>
</h3>
<ol start="8" style="list-style-type: decimal">
<li>To make predictions to a grid, we also need to create a prediction
distance matrix and we do this in the same way as for the data
above.</li>
</ol>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nysted.predictdata"</span><span class="op">)</span></span>
<span><span class="va">datacoords</span><span class="op">&lt;-</span><span class="va">nysted.predictdata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'x.pos'</span>, <span class="st">'y.pos'</span>, <span class="st">'impact'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">dists</span><span class="op">&lt;-</span><span class="fu"><a href="../../reference/makeDists.html">makeDists</a></span><span class="op">(</span>datacoords <span class="op">=</span> <span class="va">datacoords</span>, </span>
<span>                 knotcoords <span class="op">=</span> <span class="va">myknots</span>, </span>
<span>                 knotmat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g2k</span> <span class="op">=</span> <span class="va">dists</span><span class="op">$</span><span class="va">dataDist</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make predictions on response scale</span></span>
<span><span class="va">nysted.predictdata</span><span class="op">$</span><span class="va">preds</span><span class="op">&lt;-</span><span class="fu"><a href="../../reference/predict.gamMRSea.html">predict.gamMRSea</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">nysted.predictdata</span>, </span>
<span>                                           g2k <span class="op">=</span><span class="va">g2k</span>, </span>
<span>                                           object <span class="op">=</span> <span class="va">mymodel</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the predictions pre and post impact:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.pos</span>, y<span class="op">=</span><span class="va">y.pos</span>, fill<span class="op">=</span><span class="va">preds</span><span class="op">)</span>, height<span class="op">=</span><span class="fl">0.5</span>, width<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>            data<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nysted.predictdata</span>, <span class="va">season</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>,name<span class="op">=</span><span class="st">"Estimated Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Easting (Km)'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Northing (Km)'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">impact</span>, ncol<span class="op">=</span><span class="fl">1</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>impact <span class="op">=</span> <span class="va">imp.labs</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Interactions_salsa2d_MRSea_files/figure-html/unnamed-chunk-17-1.png" width="864" style="display: block; margin: auto;"></p>
<p>and, since this is simulated data, we can also look at the truth:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.pos</span>, y<span class="op">=</span><span class="va">y.pos</span>, fill<span class="op">=</span><span class="va">truth.re</span><span class="op">)</span>, height<span class="op">=</span><span class="fl">0.5</span>, width<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>            data<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nysted.predictdata</span>, <span class="va">season</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>,name<span class="op">=</span><span class="st">"Estimated Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Easting (Km)'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Northing (Km)'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">impact</span>, ncol<span class="op">=</span><span class="fl">1</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>impact <span class="op">=</span> <span class="va">imp.labs</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Interactions_salsa2d_MRSea_files/figure-html/unnamed-chunk-18-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="choosing-your-own-starting-knot-locations">Choosing your own starting knot locations<a class="anchor" aria-label="anchor" href="#choosing-your-own-starting-knot-locations"></a>
</h2>
<p>In the above analysis, the SALSA algorithm will space-fill across all
knot locations to initialise the first set of knots. This could mean
that in the initial step, one of the levels gets very few starting
locations. If you wish to have a more even set of starting locations,
you can specify these locations. Here I am specifying 5 locations from
each level of the interaction.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">startknotlocs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/selectFctrStartk.html">selectFctrStartk</a></span><span class="op">(</span><span class="va">myknots</span>, <span class="fl">5</span>, s.eed <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Greater than 1 optimal design; keeping first one......"</span></span>
<span><span class="co">#&gt; [1] "Greater than 1 optimal design; keeping first one......"</span></span></code></pre></div>
<p>The set up of the model is a little different and I have included
<code>##</code> below to indicate which lines have been
changed/added.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">salsa2dlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fitnessMeasure <span class="op">=</span> <span class="st">'QAIC'</span>,</span>
<span>                    knotgrid <span class="op">=</span> <span class="va">myknots</span>,</span>
<span>                    startKnots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">startknotlocs</span><span class="op">)</span>, <span class="co">##</span></span>
<span>                    minKnots <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    maxKnots <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                    gap <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">salsa2doutput_stkn</span><span class="op">&lt;-</span><span class="fu"><a href="../../reference/runSALSA2D.html">runSALSA2D</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">initialModel</span>, </span>
<span>                                salsa2dlist <span class="op">=</span> <span class="va">salsa2dlist</span>, </span>
<span>                                d2k<span class="op">=</span> <span class="va">d2k</span>, k2k <span class="op">=</span> <span class="va">k2k</span>, </span>
<span>                                initialise<span class="op">=</span><span class="cn">FALSE</span>,  <span class="co">##</span></span>
<span>                                initialKnPos <span class="op">=</span> <span class="va">startknotlocs</span>, <span class="co">##</span></span>
<span>                                suppress.printout <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>As before, we can look to see where the model has placed the knots.
The starting locations are a grey box with a cross and the final
locations are red diamonds</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mymodel_sk</span><span class="op">&lt;-</span><span class="va">salsa2doutput_stkn</span><span class="op">$</span><span class="va">bestModel</span></span>
<span><span class="va">chosenknots_sk</span> <span class="op">&lt;-</span> <span class="va">myknots</span><span class="op">[</span><span class="va">mymodel_sk</span><span class="op">$</span><span class="va">splineParams</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">knotPos</span>,<span class="op">]</span></span>
<span><span class="va">startingknots</span> <span class="op">&lt;-</span> <span class="va">myknots</span><span class="op">[</span><span class="va">startknotlocs</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">chosenknots_sk</span>, <span class="va">impact</span><span class="op">)</span></span>
<span><span class="co">#&gt;   impact n</span></span>
<span><span class="co">#&gt; 1      0 7</span></span>
<span><span class="co">#&gt; 2      1 5</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># quick look to see what was chosen</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">myknots</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.pos</span>, y<span class="op">=</span><span class="va">y.pos</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.pos</span>, y<span class="op">=</span><span class="va">y.pos</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,data<span class="op">=</span><span class="va">chosenknots_sk</span>, alpha<span class="op">=</span><span class="fl">4</span><span class="op">/</span><span class="fl">5</span>, </span>
<span>             show.legend <span class="op">=</span> <span class="cn">FALSE</span>, shape<span class="op">=</span><span class="fl">5</span>, colour <span class="op">=</span> <span class="st">'firebrick'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.pos</span>, y<span class="op">=</span><span class="va">y.pos</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">7</span>, data<span class="op">=</span><span class="va">startingknots</span>, </span>
<span>             colour <span class="op">=</span> <span class="st">'darkgrey'</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Easting (Km)'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Northing (Km)'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">impact</span>, ncol<span class="op">=</span><span class="fl">1</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>impact<span class="op">=</span><span class="va">imp.labs</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Interactions_salsa2d_MRSea_files/figure-html/unnamed-chunk-24-1.png" alt="Black dots are candidate knot locations, grey squares with crosses are initial knot locations and red diamonds are final knot locations." width="768"><p class="caption">
Black dots are candidate knot locations, grey squares with crosses are
initial knot locations and red diamonds are final knot locations.
</p>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../../reference/cv.gamMRSea.html">cv.gamMRSea</a></span><span class="op">(</span><span class="va">mydata</span>, <span class="va">mymodel_sk</span>, K<span class="op">=</span><span class="fl">10</span>, s.eed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 5.940744</span></span></code></pre></div>
<p>This model is better than the earlier one which used a space-filled
selection of all knots for starting locations. However, bear in mind
that both models are using a simplistic number of start knots and could
be improved.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make predictions on response scale</span></span>
<span><span class="va">nysted.predictdata</span><span class="op">$</span><span class="va">preds_sk</span><span class="op">&lt;-</span><span class="fu"><a href="../../reference/predict.gamMRSea.html">predict.gamMRSea</a></span><span class="op">(</span>newdata <span class="op">=</span> <span class="va">nysted.predictdata</span>, </span>
<span>                                           g2k <span class="op">=</span><span class="va">g2k</span>, </span>
<span>                                           object <span class="op">=</span> <span class="va">mymodel_sk</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the predictions pre and post impact:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x.pos</span>, y<span class="op">=</span><span class="va">y.pos</span>, fill<span class="op">=</span><span class="va">preds_sk</span><span class="op">)</span>, height<span class="op">=</span><span class="fl">0.5</span>, width<span class="op">=</span><span class="fl">0.5</span>,</span>
<span>            data<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">nysted.predictdata</span>, <span class="va">season</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_equal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>,name<span class="op">=</span><span class="st">"Estimated Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Easting (Km)'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Northing (Km)'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">impact</span>, ncol<span class="op">=</span><span class="fl">1</span>, labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span>impact <span class="op">=</span> <span class="va">imp.labs</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Interactions_salsa2d_MRSea_files/figure-html/unnamed-chunk-27-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lindesay Scott-Hayward, Cameron Walker, Monique Mackenzie.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
