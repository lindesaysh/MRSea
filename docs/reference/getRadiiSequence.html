<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function for obtaining a sequence of range parameters for the bivariate CReSS smoother"><title>Function for obtaining a sequence of range parameters for the bivariate CReSS smoother — getRadiiSequence • MRSea</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function for obtaining a sequence of range parameters for the bivariate CReSS smoother — getRadiiSequence"><meta property="og:description" content="Function for obtaining a sequence of range parameters for the bivariate CReSS smoother"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MRSea</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/web/IntroductiontoMRSea.html">Introduction to the package</a>
    <h6 class="dropdown-header" data-toc-skip>Basic examples</h6>
    <a class="dropdown-item" href="../articles/GettingStarted_1Dsmoothing.html">One-dimensional smooths</a>
    <a class="dropdown-item" href="../articles/GettingStarted_2Dsmoothing.html">Two-dimensional smooths</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/web/FittingDifferentSplines_MRSea.html">Using Different Splines</a>
    <a class="dropdown-item" href="../articles/web/Interactions_salsa2d_MRSea.html">Interactions for 2D smooths</a>
    <a class="dropdown-item" href="../articles/web/ModelDiagnostics_MRSea.html">Model Diagnostics</a>
    <a class="dropdown-item" href="../articles/web/TheTweedieDistribution_MRSea.html">Using the Tweedie Distribution</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/web/Publications.html">Publications</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/web/DistanceSampling.html">Brief Intro to Distance Sampling</a>
    <a class="dropdown-item" href="../articles/web/RenewablesCaseStudy_MRSea.html">Renewables Case Study</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>More advanced Usage</h6>
    <a class="dropdown-item" href="../articles/web/Geodesic_2dsmoothing_MRSea.html">Geodesic smoothing</a>
    <a class="dropdown-item" href="../articles/web/UserRadiiChoice_MRSea.html">Basis radii selection</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lindesaysh/MRSea/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Function for obtaining a sequence of range parameters for the bivariate CReSS smoother</h1>
      <small class="dont-index">Source: <a href="https://github.com/lindesaysh/MRSea/blob/HEAD/R/getRadiiSequence.R" class="external-link"><code>R/getRadiiSequence.R</code></a></small>
      <div class="d-none name"><code>getRadiiSequence.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function for obtaining a sequence of range parameters for the bivariate CReSS smoother</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getRadiiSequence</span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  numberofradii <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  <span class="va">distMatrix</span>,</span>
<span>  <span class="va">basis</span>,</span>
<span>  rvin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">xydata</span>,</span>
<span>  <span class="va">response</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  vgmmodel <span class="op">=</span> <span class="st">"Sph"</span>,</span>
<span>  showplots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>method</dt>
<dd><p>One of "original" or "variogram". The original method is described in Scott-Hayward et al 2013 (reference below) and the variogram method is in the <a href="https://lindesaysh.github.io/MRSea/articles/web/UserRadiiChoice_MRSea.html" class="external-link">vignette for variogram radii selection</a></p></dd>


<dt>numberofradii</dt>
<dd><p>The number of range parameters for SALSA to use when fitting the CReSS smooth.  The default is 8.  Remember, the more parameters the longer SALSA will take to find a suitable one for each knot location.</p></dd>


<dt>distMatrix</dt>
<dd><p>Matrix of distances between data locations and knot locations (n x k). May be Euclidean or geodesic distances. Euclidean distances created using <code><a href="makeDists.html">makeDists</a></code>.</p></dd>


<dt>basis</dt>
<dd><p>character stating whether a 'gaussian' or 'exponential' basis is being used.
#' @param rvin Optional if <code>method = "original"</code>. Two parameter vector stating the minimum and maximum range of r for a gaussian basis.</p></dd>


<dt>xydata</dt>
<dd><p>Required if `method = "variogram". Data frame containing columns for x and y coordinates. x is assumed to be the first of the two columns</p></dd>


<dt>response</dt>
<dd><p>Required if <code>method = "variogram"</code>. Vector of response values for use in <code><a href="https://rdrr.io/pkg/gstat/man/variogram.html" class="external-link">gstat::variogram</a></code>.  These values should be approximately normally distributed.</p></dd>


<dt>alpha</dt>
<dd><p>Optional if <code>method = "variogram"</code>. Numeric parameter for the <code><a href="https://rdrr.io/pkg/gstat/man/variogram.html" class="external-link">gstat::variogram</a></code> function giving the direction in plane(x,y)</p></dd>


<dt>showplots</dt>
<dd><p>(<code>default = FALSE</code>). Optional if <code>method = "variogram"</code>. If <code>TRUE</code> the output of <code><a href="https://rdrr.io/pkg/gstat/man/variogram.html" class="external-link">gstat::variogram</a></code> and <code><a href="https://rdrr.io/pkg/gstat/man/fit.variogram.html" class="external-link">gstat::fit.variogram</a></code> are shown.</p></dd>


<dt>...</dt>
<dd><p>Other parameters for the <code><a href="https://rdrr.io/pkg/gstat/man/variogram.html" class="external-link">gstat::variogram</a></code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<ul><li><p>Original method: This function returns a vector containing a sequence of range parameters.</p></li>
<li><p>Variogram method: This function returns a vector containing a sequence of range parameters.  If an even number of radii is requested, this is reduced by one to give an odd length sequence where the middle number was the best range parameter from the variogram. The outputs of the variogram model can be found in the attributes of the returned object under <code>vg.fit</code>.</p></li>
</ul><p><strong>Note</strong> If the estimated range from the variogram model exceeds the maximum distance in the distance matrix, the sequence reverts to the original method. A warning will be printed and the method used is an attribute in the returned sequence ("Method").</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The range parameter determines the range of the influence of each knot.  Small numbers indicate local influence and large ones, global influence.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Scott-Hayward, L.; M. Mackenzie, C.Donovan, C.Walker and E.Ashe.  Complex Region Spatial Smoother (CReSS). Journal of computational and Graphical Statistics. 2013.
DOI: 10.1080/10618600.2012.762920</p>
<p><a href="https://lindesaysh.github.io/MRSea/articles/web/UserRadiiChoice_MRSea.html" class="external-link">vignette for variogram radii selection</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ns.data.re</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rad.dat</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ns.data.re</span>, <span class="va">impact</span><span class="op">==</span><span class="fl">0</span>, <span class="va">Year</span><span class="op">==</span><span class="fl">9</span>, <span class="va">MonthOfYear</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># load knot grid data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">knotgrid.ns</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make distance matrices for datatoknots and knottoknots</span></span></span>
<span class="r-in"><span><span class="va">distMats</span><span class="op">&lt;-</span><span class="fu"><a href="makeDists.html">makeDists</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">rad.dat</span><span class="op">$</span><span class="va">x.pos</span>, <span class="va">rad.dat</span><span class="op">$</span><span class="va">y.pos</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">knotgrid.ns</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># choose sequence of radii</span></span></span>
<span class="r-in"><span><span class="va">r_seq</span><span class="op">&lt;-</span><span class="fu">getRadiiSequence</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"variogram"</span>,</span></span>
<span class="r-in"><span>                        numberofradii <span class="op">=</span> <span class="fl">8</span>, </span></span>
<span class="r-in"><span>                        xydata <span class="op">=</span> <span class="va">rad.dat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x.pos"</span>, <span class="st">"y.pos"</span><span class="op">)</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                        response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rad.dat</span><span class="op">$</span><span class="va">birds</span> <span class="op">+</span><span class="fl">1</span> <span class="op">)</span>, </span></span>
<span class="r-in"><span>                        basis <span class="op">=</span> <span class="st">"gaussian"</span>, </span></span>
<span class="r-in"><span>                        distMatrix <span class="op">=</span> <span class="va">distMats</span><span class="op">$</span><span class="va">dataDist</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r_seq</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0025322476 0.0013154870 0.0008885387 0.0006708204 0.0002961796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 0.0001900437 0.0001399078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Method")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Variogram"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"vg.fit")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model     psill    range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Nug 0.5771075    0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Sph 0.8376254 1054.093</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">r_seq</span>, <span class="st">"vg.fit"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   model     psill    range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   Nug 0.5771075    0.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   Sph 0.8376254 1054.093</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">r_seq</span>, <span class="st">"Method"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Variogram"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">r_seq</span><span class="op">&lt;-</span><span class="fu">getRadiiSequence</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"original"</span>,</span></span>
<span class="r-in"><span>                         numberofradii <span class="op">=</span> <span class="fl">8</span>, </span></span>
<span class="r-in"><span>                         distMatrix <span class="op">=</span> <span class="va">distMats</span><span class="op">$</span><span class="va">dataDist</span>, </span></span>
<span class="r-in"><span>                         basis<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">r_seq</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0007538918 0.0006100646 0.0004936767 0.0003994933 0.0003232781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 0.0002616033 0.0002116947 0.0001713077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"Method")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Original"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">r_seq</span>, <span class="st">"Method"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Original"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Lindesay Scott-Hayward, Cameron Walker, Monique Mackenzie.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

