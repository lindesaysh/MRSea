"0","data(""nysted.predictdata"")"
"0","datacoords<-nysted.predictdata[,c('x.pos', 'y.pos', 'impact')]"
"0","dists<-makeDists(datacoords = datacoords[,1:2], knotcoords = kg, knotmat = FALSE)"
"0","g2k = dists$dataDist"
"0",""
"0","n.level<-length(unique(myknots[,3]))"
"0","nk.in.level<-data.frame(myknots %>% "
"0","                          mutate(id = row_number()) %>% "
"0","                          group_by(impact) %>% "
"0","                          summarise(beg=first(id), end=last(id)))"
"0","ncoords.in.level <- data.frame(datacoords %>%"
"0","                                 mutate(id = row_number()) %>% "
"0","                                 group_by(impact) %>% "
"0","                                 summarise(beg=first(id), end=last(id)))"
"0","g2k_temp<-matrix(Inf, nrow = nrow(g2k), ncol = ncol(g2k))"
"0","for(i in 1:n.level){"
"0","  kid<-nk.in.level[i,'beg']:nk.in.level[i,'end']"
"0","  gid<-ncoords.in.level[i,'beg']:ncoords.in.level[i,'end']"
"0","  g2k_temp[gid,kid]<-g2k[gid, kid]"
"0","}"
"0","g2k<-g2k_temp"
