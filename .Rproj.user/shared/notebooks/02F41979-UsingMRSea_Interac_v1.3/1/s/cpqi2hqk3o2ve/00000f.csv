"0","require(dplyr)"
"0","dists<-makeDists(datacoords = mydata[,c('x.pos', 'y.pos')], knotcoords = kg, knotmat = TRUE)"
"0","d2k = dists$dataDist"
"0","k2k = dists$knotDist"
"0",""
"0","n.level<-length(unique(myknots[,3]))"
"0","nk.in.level<-data.frame(myknots %>% "
"0","                          mutate(id = row_number()) %>% "
"0","                          group_by(impact) %>% "
"0","                          summarise(beg=first(id), end=last(id)))"
"0","k2k_temp<-matrix(Inf, nrow = nrow(k2k), ncol = ncol(k2k))"
"0","for(i in 1:n.level){"
"0","  kid<-nk.in.level[i,'beg']:nk.in.level[i,'end']"
"0","  k2k_temp[kid,kid]<-k2k[kid, kid]"
"0","}"
"0","k2k<-k2k_temp"
"0",""
"0","n.level<-length(unique(myknots[,3]))"
"0","nk.in.level<-data.frame(myknots %>% mutate(id = row_number()) %>% "
"0","                          group_by(impact) %>% "
"0","                          summarise(beg=first(id), end=last(id)))"
"0","ncoords.in.level <- data.frame(mydata %>% "
"0","                                 mutate(id = row_number()) %>% "
"0","                                 group_by(impact) %>% summarise(beg=first(id), end=last(id)))"
"0","d2k_temp<-matrix(Inf, nrow = nrow(d2k), ncol = ncol(d2k))"
"0","for(i in 1:n.level){"
"0","  kid<-nk.in.level[i,'beg']:nk.in.level[i,'end']"
"0","  did<-ncoords.in.level[i,'beg']:ncoords.in.level[i,'end']"
"0","  d2k_temp[did,kid]<-d2k[did, kid]"
"0","}"
"0","d2k<-d2k_temp"
"0",""
